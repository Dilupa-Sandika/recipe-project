---
// src/pages/index.astro (Restored full version)
import BaseLayout from '../layouts/BaseLayout.astro';
import RecipeCard from '../components/RecipeCard.astro';
import { getCollection } from 'astro:content';

// Get all published recipes
const allRecipes = await getCollection('recipes', ({ data }) => data.publishDate <= new Date());

// Sort newest first
allRecipes.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());

// Filter featured recipes
const featuredRecipes = allRecipes.filter(({ data }) => data.isFeatured);

// SEO Props for Homepage
const seoProps = {
  title: 'Home | Vegas Recipes',
  description: 'Find the best, simple, and delicious recipes for Las Vegas home cooks.'
};
---
{/* Styles for Homepage */}
<style>
  .hero-section {
    background: linear-gradient(135deg, #FF6B6B 0%, #FFB88C 100%);
    border-radius: 12px;
    padding: 5rem 2rem;
    text-align: center;
    color: white;
    box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
  }
  .hero-title { font-size: 3.5rem; font-weight: 900; color: white; line-height: 1.2; }
  .hero-subtitle { font-size: 1.15rem; color: white; opacity: 0.9; max-width: 600px; margin: 1rem auto 0; }
  .section-title { font-size: 2.2rem; font-weight: 700; margin-top: 3.5rem; margin-bottom: 2rem; border-bottom: 3px solid var(--color-primary); padding-bottom: 0.5rem; display: inline-block; }
  .recipe-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }
  .search-container { margin-top: 2rem; display: flex; justify-content: center; }
  #recipe-search { width: 100%; max-width: 720px; padding: 0.75rem 1rem; border-radius: 8px; border: 1px solid var(--color-border); font-size: 1rem; }
  .empty-message { display: none; margin-top: 1rem; color: var(--color-text-light); text-align: center; }
  .pagination { margin-top: 2rem; text-align: center; }
  .pagination button {
    background-color: var(--color-primary);
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    margin: 0 0.25rem;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  .pagination button:hover:not(:disabled) { background-color: var(--color-primary-dark); }
  .pagination button:disabled { background-color: #ccc; cursor: default; }
  .pagination span { margin: 0 0.5rem; color: var(--color-text-light); }
</style>

<BaseLayout seo={seoProps}>
  <section class="hero-section">
    <h1 class="hero-title">Delicious Recipes for Everyone</h1>
    <p class="hero-subtitle">Welcome to Vegas Recipes. Find simple, tasty recipes for every occasion.</p>
  </section>

  <div class="search-container">
    <input id="recipe-search" type="search" placeholder="Search recipes by title or tag..." />
  </div>

  {featuredRecipes.length > 0 && (
    <section class="featured-recipes">
      <h2 class="section-title">Featured Recipes</h2>
      {/* ID එක search.js එකට ඕන */}
      <div id="featured-grid" class="recipe-grid">
        {featuredRecipes.map(recipe => (
          <RecipeCard recipe={recipe} />
        ))}
      </div>
      {/* ID එක search.js එකට ඕන */}
      <p id="featured-empty" class="empty-message">No featured recipes match your search.</p>
    </section>
  )}

  <section class="all-recipes" id="all-recipes">
    <h2 class="section-title">All Recipes</h2>
    {/* ID එක search.js එකට ඕන */}
    <div id="all-grid" class="recipe-grid">
      {allRecipes.map(recipe => (
        <RecipeCard recipe={recipe} />
      ))}
    </div>
     {/* ID එක search.js එකට ඕන */}
    <p id="all-empty" class="empty-message">No recipes match your search.</p>
    {/* ID එක search.js එකට ඕන */}
    <div id="recipe-pager" class="pagination"></div>
  </section>
</BaseLayout>